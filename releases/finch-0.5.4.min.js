/*
	Finch.js - Powerfully simple javascript routing
	by Rick Allen (stoodder) and Greg Smith (smrq)

	Version 0.5.4
	Full source at https://github.com/stoodder/finchjs
	Copyright (c) 2011 RokkinCat, http://www.rokkincat.com

	MIT License, https://github.com/stoodder/finchjs/blob/master/LICENSE.md
	This file is generated by `cake build`, do not edit it by hand.
*/
(function(){var n,e,t,r,l,i,u,o,a,c,s,f,h,d,p,g,v,b,w,m,y,x,O,V,E,P,S,L,j,I,B,C,T,k,q,N,F,$,z,A,M,R,G,H,W,D,J,K,Q,U,X,Y,Z,_,ne,ee,te,re,le,ie,ue,oe,ae=[].slice;A=function(n){return typeof n==typeof{}&&null!==n},$=function(n){return"[object Function]"===Object.prototype.toString.call(n)},F=function(n){return"[object Boolean]"===Object.prototype.toString.call(n)},N=function(n){return"[object Array]"===Object.prototype.toString.call(n)},M=function(n){return"[object String]"===Object.prototype.toString.call(n)},z=function(n){return"[object Number]"===Object.prototype.toString.call(n)},le=function(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")},ie=function(n){return n.replace(/^\//,"").replace(/\/$/,"")},Z=function(n,e){return 0===n.indexOf(e)},L=function(n,e){return-1!==n.indexOf(e,n.length-e.length)},E=function(n,e){var t,r,l;if($(n.indexOf))return-1!==n.indexOf(e);if(N(n))for(r=0,l=n.length;l>r;r++)if(t=n[r],t===e)return!0;return!1},K=function(n){return n[n.length-1]},P=function(n,e){return n.split(e).length-1},R=function(n){var e,t;t=[];for(e in n)t.push(e);return t},G=function(n){var e,t,r;r=[];for(e in n)t=n[e],r.push(t);return r},j=function(n,e){var t,r;A(n)||(n={}),A(e)||(e={});for(t in e)r=e[t],n[t]=r;return n},O=function(n){var e,t,r;A(n)||(n={}),t={};for(e in n)r=n[e],null!=r&&(t[e]=r);return t},H=function(n,e){var t,r;for(t in n)if(r=n[t],e[t]!==r)return!1;for(t in e)if(r=e[t],n[t]!==r)return!1;return!0},x=function(n,e){var t,r,l,i;if(n.length!==e.length)return!1;for(t=l=0,i=n.length;i>l;t=++l)if(r=n[t],e[t]!==r)return!1;return!0},S=function(n,e){var t,r,l;null==n&&(n={}),null==e&&(e={}),r={};for(t in n)l=n[t],e[t]!==l&&(r[t]=e[t]);for(t in e)l=e[t],n[t]!==l&&(r[t]=l);return r},(V===void 0||null===V)&&(V={}),null==(ue=V.log)&&(V.log=function(){}),null==(oe=V.warn)&&(V.warn=function(){}),d=function(){function n(n){var e,t;t=n.components,e=n.childIndex,this.components=null!=t?t:[],this.childIndex=null!=e?e:0}return n}(),v=function(){function n(n){var e,t,r,l;l=null!=n?n:{},e=l.name,t=l.nodeType,r=l.parent,this.name=null!=e?e:"",this.nodeType=null!=t?t:null,this.parent=null!=r?r:null,this.routeSettings=null,this.childLiterals={},this.childVariable=null,this.bindings=[]}return n}(),w=function(){function n(n){var e,t,r,l,i,u;u=null!=n?n:{},r=u.setup,l=u.teardown,t=u.load,i=u.unload,e=u.context,this.setup=$(r)?r:function(){},this.load=$(t)?t:function(){},this.unload=$(i)?i:function(){},this.teardown=$(l)?l:function(){},this.context=A(e)?e:{}}return n}(),b=function(){function n(n){var e,t,r,l;l=null!=n?n:{},t=l.node,e=l.boundValues,r=l.parameterObservables,this.node=null!=t?t:null,this.boundValues=null!=e?e:[],this.parameterObservables=null!=r?r:[[]]}return n.prototype.getBindings=function(){var n,e,t,r,l,i;for(e={},i=this.node.bindings,t=r=0,l=i.length;l>r;t=++r)n=i[t],e[n]=this.boundValues[t];return W(e)},n.prototype.isEqual=function(n){return null!=n&&this.node===n.node&&x(this.boundValues,n.boundValues)},n.prototype.isRoot=function(){return null==this.node.parent},n.prototype.getParent=function(){var e,t,r,l,i;return null==this.node?null:(e=null!=(l=null!=(i=this.node.parent)?i.bindings.length:void 0)?l:0,t=this.boundValues.slice(0,e),r=this.parameterObservables.slice(0,-1),new n({node:this.node.parent,boundValues:t,parameterObservables:r}))},n.prototype.getChild=function(n){for(var e;null!=n&&!this.isEqual(e=n.getParent());)n=e;return n.parameterObservables=this.parameterObservables.slice(0),n.parameterObservables.push([]),n},n}(),h=function(){function n(n){this.callback=n,$(this.callback)||(this.callback=function(){}),this.dependencies=[],this.initialized=!1}return n.prototype.notify=function(n){var e,t=this;return e=function(){var e,r,l,i;if(!t.initialized)return!0;for(i=t.dependencies,r=0,l=i.length;l>r;r++)if(e=i[r],E(n,e))return!0;return!1}(),e?this.trigger():void 0},n.prototype.trigger=function(){var n,t=this;return this.dependencies=[],n=function(n){return E(t.dependencies,n)||t.dependencies.push(n),e[n]},this.callback(n),this.initialized=!0},n}(),s=new b({node:null}),c={Literal:"Literal",Variable:"Variable"},D=function(n){var e,t,r,l,i,u,o,a;if(n=M(n)?le(n):"",r={},""!==n)for(o=n.split("&"),i=0,u=o.length;u>i;i++)t=o[i],a=t.split("=",2),e=a[0],l=a[1],r[e]=l;return W(r)},k=function(){var n;return"#"+(null!=(n=window.location.href.split("#",2)[1])?n:"")},X=function(n){return M(n)||(n=""),n=le(n),"#"===n.slice(0,1)&&(n=n.slice(1)),window.location.hash=n},W=function(n){var e,t;if(A(n)||(n={}),f.CoerceParameterTypes)for(e in n)t=n[e],"true"===t?t=!0:"false"===t?t=!1:/^[0-9]+$/.test(t)?t=parseInt(t):/^[0-9]+\.[0-9]*$/.test(t)&&(t=parseFloat(t)),n[e]=t;return n},Y=function(n){var e;return n=ie(n),e=""===n?[]:n.split("/"),e.unshift("/"),e},J=function(n){var e,t,r,l,i,u,o,a,c;for(i=E(n,"[")||E(n,"]"),i&&function(){var e,t;return t=P(n,"["),1!==t?(t>1&&V.warn('Parsing failed on "'+n+'": Extra ['),1>t&&V.warn('Parsing failed on "'+n+'": Missing ['),null):(e=P(n,"]"),1!==e?(e>1&&V.warn('Parsing failed on "'+n+'": Extra ]'),1>e&&V.warn('Parsing failed on "'+n+'": Missing ]'),null):Z(n,"[")?void 0:(V.warn('Parsing failed on "'+n+'": [ not at beginning'),null))}(),l=n.replace(/[\[\]]/g,""),r=""===l?[]:Y(l),a=0,c=r.length;c>a;a++)if(t=r[a],""===t)return V.warn('Parsing failed on "'+n+'": Blank component'),null;if(e=0,i){if(o=n.split("]")[0],u=Y(o.replace("[","")),u[u.length-1]!==r[u.length-1])return V.warn('Parsing failed on "'+n+'": ] in the middle of a component'),null;if(u.length===r.length)return V.warn('Parsing failed on "'+n+'": No child components'),null;e=u.length}return new d({components:r,childIndex:e})},T=function(n){return Z(n,":")?c.Variable:c.Literal},C=function(n){switch(T(n)){case c.Literal:return n;case c.Variable:return n.slice(1)}},y=function(n,e,t){var r,l,i,u,o;return i=e.components,l=e.childIndex,u=n,r=[],(o=function(a,s){var f,h,d,p,g,b,m;if(s===l&&(u=a),0>=e.components.length)return a.parent=u,a.bindings=r,a.routeSettings=new w(t);switch(f=i.shift(),d=T(f),h=C(f),d){case c.Literal:p=null!=(b=(g=a.childLiterals)[h])?b:g[h]=new v({name:""+a.name+f+"/",nodeType:d,parent:n});break;case c.Variable:p=null!=(m=a.childVariable)?m:a.childVariable=new v({name:""+a.name+f+"/",nodeType:d,parent:n}),r.push(h)}return o(p,s+1)})(n,0)},B=function(n,e){var t,r,l;return l=Y(e),t=[],(r=function(n,e){var l,i;if(0>=e.length&&null!=n.routeSettings)return new b({node:n,boundValues:t});if(l=e[0],null!=n.childLiterals[l]&&(i=r(n.childLiterals[l],e.slice(1)),null!=i))return i;if(null!=n.childVariable){if(t.push(l),i=r(n.childVariable,e.slice(1)),null!=i)return i;t.pop()}return null})(n,l)},I=function(n,e){var t,r,l,i,u;for(r=[],l=e;null!=l;)r.push(l),l=l.getParent();for(l=n;null!=l;){for(i=0,u=r.length;u>i;i++)if(t=r[i],l.isEqual(t))return l;l=l.getParent()}return null},g=t=r=null,p=e=null,i=n=null,u=!1,o=m=!1,a=!1,f={CoerceParameterTypes:!1},(Q=function(){return g=new v({name:"*"}),t=s,p={},e={},r=null,i=null,n=null,u=!1,o=!1,m=!1,a=!1})(),_=function(){var n;return null===r?U():a?re():r.isEqual(t)?ne():(n=I(t,r),t.isEqual(n)?ee():te())},ee=function(){var n,e,l,i,u,o,a,c,s,f;return m=!0,i=(null!=(a=null!=(c=t.node)?c.routeSettings:void 0)?a:{context:null}).context,t=t.getChild(r),f=null!=(s=t.node.routeSettings)?s:{},e=f.context,o=f.setup,l=f.load,null==e&&(e={}),e.parent=i,null==o&&(o=function(){}),null==l&&(l=function(){}),n=t.getBindings(),u=function(){return _()},2===o.length?o.call(e,n,u):(o.call(e,n),u())},ne=function(){var n,e,l,i,u,o,c;return i=function(){return a=!0,r=null,_()},null==t.node?i():(c=null!=(o=t.node.routeSettings)?o:{},e=c.context,u=c.setup,l=c.load,null==e&&(e={}),null==u&&(u=function(){}),null==l&&(l=function(){}),n=t.getBindings(),2===l.length?l.call(e,n,i):(l.call(e,n),i()))},re=function(){var n,e,r,l,i,u;return a=!1,r=function(){return _()},u=null!=(i=t.node.routeSettings)?i:{},e=u.context,l=u.unload,null==e&&(e={}),null==l&&(l=function(){}),n=t.getBindings(),2===l.length?l.call(e,n,r):(l.call(e,n),r())},te=function(){var n,e,r,l,i,u;return m=!1,u=null!=(i=t.node.routeSettings)?i:{},e=u.context,l=u.teardown,null==e&&(e={}),null==l&&(l=function(){}),n=t.getBindings(),r=function(){return t=t.getParent(),_()},2===l.length?l.call(e,n,r):(l.call(e,n),r())},U=function(){var n,r,l,i,u,o,a;for(n=R(S(p,e)),p=e,o=t.parameterObservables,a=[],i=0,u=o.length;u>i;i++)l=o[i],a.push(function(){var e,t,i;for(i=[],e=0,t=l.length;t>e;e++)r=l[e],i.push(r.notify(n));return i}());return a},q=function(){var e;return e=k(),Z(e,"#")&&(e=e.slice(1)),e=unescape(e),e!==n?l.call(e)?n=e:X(null!=n?n:""):void 0},l={route:function(n,e){var t,r;return $(e)&&(t=e,e={setup:t},e.load=2===t.length?function(n,e){return m?e():(o=!0,t(n,e))}:function(n){return m?void 0:(o=!0,t(n))}),A(e)||(e={}),M(n)||(n=""),n=le(n),n.length>0||(n="/"),r=J(n),null==r?!1:(y(g,r,e),!0)},call:function(n){var l,i,u,o,a,c;return M(n)||(n="/"),""===n&&(n="/"),c=n.split("?",2),n=c[0],a=c[1],i=B(g,n),null==i?(V.log("FINCH WARNING: Could not find route for: "+n),!1):(o=D(a),l=i.getBindings(),e=j(o,l),null===r&&t.isEqual(i)?_():(u=r,r=i,null==u&&_()),!0)},reload:function(){return a?null==t||null==t.node?this:(r=t,_(),this):this},observe:function(){var n,e,r,i;return n=arguments.length>=1?ae.call(arguments,0):[],o?o=!1:(e=n.pop(),$(e)||(e=function(){}),n.length>0?(r=1===n.length&&N(n[0])?n[0]:n,l.observe(function(n){var t,l;return l=function(){var e,l,i;for(i=[],e=0,l=r.length;l>e;e++)t=r[e],i.push(n(t));return i}(),e.apply(null,l)})):(i=new h(e),K(t.parameterObservables).push(i)))},abort:function(){return r=null},listen:function(){return u||("onhashchange"in window&&($(window.addEventListener)?(window.addEventListener("hashchange",q,!0),u=!0):$(window.attachEvent)&&(window.attachEvent("hashchange",q),u=!0)),u||(i=setInterval(q,33),u=!0),q()),u},ignore:function(){return u&&(null!==i?(clearInterval(i),i=null,u=!1):"onhashchange"in window&&($(window.removeEventListener)?(window.removeEventListener("hashchange",q,!0),u=!1):$(window.detachEvent)&&(window.detachEvent("hashchange",q),u=!1))),!u},navigate:function(n,e,t){var r,l,i,u,o,a,c,s,f,h,d,p,g;if(p=k().split("?",2),u=p[0],i=p[1],null==u&&(u=""),null==i&&(i=""),"#"===u.slice(0,1)&&(u=u.slice(1)),u=unescape(u),l=D(i),F(e)&&(t=e),A(n)&&(e=n),M(n)||(n=""),A(e)||(e={}),F(t)||(t=!1),n=le(n),0===n.length&&(n=null),t&&(function(){var n,e,t;e={};for(n in l)t=l[n],e[unescape(n)]=unescape(t);return l=e}(),e=j(l,e)),null===n&&(n=u),g=n.split("?",2),n=g[0],f=g[1],"#"===n.slice(0,1)&&(n=n.slice(1)),Z(n,"./")||Z(n,"../")){for(r=u;Z(n,"./")||Z(n,"../");)s=n.indexOf("/"),a=n.slice(0,s),n=n.slice(s+1),".."===a&&(r=r.slice(0,r.lastIndexOf("/")));n=n.length>0?""+r+"/"+n:r}return h=M(f)?D(f):{},e=j(h,e),e=O(e),n=escape(n),c=function(){var n;n=[];for(o in e)d=e[o],n.push(escape(o)+"="+escape(d));return n}().join("&"),c.length>0&&(n+="?"+c),X(n)},reset:function(){l.options({CoerceParameterTypes:!1}),r=s,_(),l.ignore(),Q()},options:function(n){return j(f,n)}},this.Finch=l}).call(this);