((function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;q=function(a){return typeof a==typeof {}},o=function(a){return Object.prototype.toString.call(a)==="[object Function]"},n=function(a){return Object.prototype.toString.call(a)==="[object Array]"},r=function(a){return Object.prototype.toString.call(a)==="[object String]"},p=function(a){return Object.prototype.toString.call(a)==="[object Number]"},z=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},A=function(a){return a.replace(/^\/+/,"").replace(/\/+$/,"")},y=function(a,b){return a.indexOf(b)===0},i=function(a,b){return a.indexOf(b,a.length-b.length)!==-1},j=function(a,b){var c,d;q(a)||(a={}),q(b)||(b={});for(c in b)d=b[c],a[c]=d;return a},t=function(a,b){var c,d;for(c in a){d=a[c];if(b[c]!==d)return!1}for(c in b){d=b[c];if(a[c]!==d)return!1}return!0},b={},h=[],f=[],e=null,g="",x=function(a){var b;return a=r(a)?z(a):"",y(a,"[")&&(b=a.indexOf("]"),b>1?a=a.slice(1,b)+a.slice(b+1):a=a.slice(Math.max(1,b+1))),a=A(a),a},m=function(a){var b,c;return a=r(a)?z(a):"",c=null,y(a,"[")&&(b=a.indexOf("]"),b>1&&(c=a.slice(1,b))),c},l=function(a,b){var c,d,e,f,g;r(b)||(b=""),r(a)||(a=""),b=x(b),a=x(a),g=b.split("/"),f=a.split("/");if(g.length!==f.length)return{};d={};for(c in f)e=f[c],y(e,":")&&(d[e.slice(1)]=g[c]);return d},u=function(a){var b,c,d,e,f,g,h,i;a=r(a)?z(a):"",d={};if(a!==""){h=a.split("&");for(f=0,g=h.length;f<g;f++)c=h[f],i=c.split("=",2),b=i[0],e=i[1],d[b]=e}return d},s=function(a,b){var c,d,e,f;a=x(a),b=x(b),f=a.split("/"),e=b.split("/");if(f.length!==e.length)return!1;for(c in e){d=e[c];if(d!==f[c]&&!y(d,":"))return!1}return!0},c=function(a){var c,d;return a=x(a),c=[],(d=function(a){var e;e=b[a];if(q(e)){o(e.setup)&&c.unshift(e);if(e.parentPattern!=null&&e.parentPattern!=="")return d(e.parentPattern)}})(a),c},v=function(a,b,c,d){var g,i,k;n(a)||(a=[]),n(b)||(b=[]),c=p(c)&&c>0?parseInt(c):0,q(d)||(d={});if(a.length<=0)return;k=a[a.length-1],i=o(k.load)?k.load:function(){},e={aborted:!1,abortedCallback:function(){},abort:function(a){return o(a)||(a=function(){}),this.aborted=!0,this.abortedCallback=function(){return e=null,a()}}},a=a.slice(c),b=b.slice(c),(g=function(a,b,c){var d,l;return e.aborted?e.abortedCallback():a.length<=0?(e=null,i.call(k.context,c,function(){})):(d=a.shift(),l=b.shift(),q(d)||(d={}),r(l)||(l=""),o(d.setup)||(d.setup=function(){}),i===d.setup&&(i=function(){}),d.setup.length===2?d.setup.call(d.context,c,function(e){return f.push(d),h.push(l),q(e)||(e={}),j(c,e),g.call(g,a,b,c)}):(d.setup.call(d.context,c),f.push(d),h.push(l),g(a,b,c)))})(a,b,d)},w=function(a,b,c){var d;n(a)||(a=[]),n(b)||(b=[]),c=p(c)&&c>0?parseInt(c):0;if(a.length<=c)return;(d=function(a,b){var e,f;if(a.length<=c)return;return e=a.pop(),f=b.pop(),q(e)||(e={}),r(f)||(f=""),o(e.teardown)||(e.teardown=function(){}),e.teardown.call(e.context),d(a,b)})(a,b)},k=function(a,b){var c;n(a)||(a=[]),n(b)||(b=[]),c=0;while(a.length>c&&b.length>c){if(a[c]!==b[c])break;c++}return c},d=function(a,c){var d,e,f;return a=x(a),c=x(c),e=c.split("/"),f=[],e.length<=0?f:((d=function(a){var g,h,j,k,l,m,n;l=a.split("/"),h="",j=!0,n=0;while(j&&l.length>n&&e.length>n)k=l[n],m=e[n],y(k,":")||k===m?h+=""+m+"/":j=!1,n++;i(h,"/")&&(h=h.slice(0,-1)),g=b[a],f.unshift(h);if((g!=null?g.parentPattern:void 0)!=null&&g.parentPattern!=="")return d(g.parentPattern,c)})(a),f)},a={route:function(a,c){var d;return o(c)&&(c={setup:c,load:c}),r(a)||(a=""),q(c)||(c={}),q(c.context)||(c.context={}),o(c.setup)||(c.setup=function(){}),o(c.load)||(c.load=function(){}),o(c.teardown)||(c.teardown=function(){}),d=m(a),c.pattern=x(a),c.parentPattern=x(d),b[c.pattern]=c},call:function(i,m){var n,o,p,y,z,A,B,C,D,E,F,G;r(i)||(i=""),q(m)||(m={}),F=i.split("?",2),C=F[0],B=F[1],C=x(C),A=u(B),j(m,A);for(z in b){p=b[z];if(s(C,z))return e!=null?e.abort(function(){return a.call(i,m)}):(j(m,l(z,C)),n=b[z],o=c(z),D=d(z,C),E=k(h,D),f.length===(G=o.length)&&G===E?t(A,g)||(y=f[f.length-1],y!=null&&y.load.call(y.context,m)):(w(f,h,E),v(o,D,E,m)),g=A,!0)}return!1},reset:function(){w(f,h,0),b={},h=[],f=[],e=null}},function(){var b,c,d;return c=null,d=!1,b=function(){var b;return b=null,function(c){var d,e,f;d="","hash"in window.location?(d=window.location.hash,y(d,"#")&&(d=d.slice(1))):(e=window.location.href,f=e.split("#",2),d=f.length===2?f[1]:"");if(d!==b)return a.call(d),b=d}}(),a.listen=function(){return d||("onhashchange"in window&&(o(window.addEventListener)?(window.addEventListener("hashchange",b,!0),d=!0):o(window.attachEvent)&&(window.attachEvent("hashchange",b),d=!0)),console.log("listening "+d),d||(c=setInterval(b,33),d=!0),b()),d},a.ignore=function(){return d&&(c!==null&&(clearInterval(c),c=null,d=!1),d&&"onhashchange"in window&&(o(window.removeEventListener)&&(window.removeEventListener("hashchange",b,!0),d=!1),d&&o(window.detachEvent)&&(window.detachEvent("hashchange",b),d=!1))),!d}}(),this.Finch=a})).call(this);