/*
	Finch.js - Powerfully simple javascript routing
	by Rick Allen (stoodder) and Greg Smith (smrq)

	Version 0.5.4
	Full source at https://github.com/stoodder/finchjs
	Copyright (c) 2011 RokkinCat, http://www.rokkincat.com

	MIT License, https://github.com/stoodder/finchjs/blob/master/LICENSE.md
	This file is generated by `cake build`, do not edit it by hand.
*/
(function(){var e,o,a,t,l,n,r,d,s,c,i,u,f,h,b,_,w,p,m,v,F,g,k,z,C,N,x,H,q,y,L,O,E,T,j,S,U,P,I,B,D,A,W,R,V,G,K,Q,M,$,J,X,Y,Z,eo,oo,ao,to,lo,no,ro,so,co=[].slice;B=function(e){return typeof e==typeof{}&&null!==e},P=function(e){return"[object Function]"===Object.prototype.toString.call(e)},U=function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},S=function(e){return"[object Array]"===Object.prototype.toString.call(e)},D=function(e){return"[object String]"===Object.prototype.toString.call(e)},I=function(e){return"[object Number]"===Object.prototype.toString.call(e)},lo=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},no=function(e){return e.replace(/^\//,"").replace(/\/$/,"")},Y=function(e,o){return 0===e.indexOf(o)},H=function(e,o){return-1!==e.indexOf(o,e.length-o.length)},C=function(e,o){var a,t,l;if(P(e.indexOf))return-1!==e.indexOf(o);if(S(e))for(t=0,l=e.length;l>t;t++)if(a=e[t],a===o)return!0;return!1},Q=function(e){return e[e.length-1]},N=function(e,o){return e.split(o).length-1},A=function(e){var o,a;a=[];for(o in e)a.push(o);return a},W=function(e){var o,a,t;t=[];for(o in e)a=e[o],t.push(a);return t},q=function(e,o){var a,t;B(e)||(e={}),B(o)||(o={});for(a in o)t=o[a],e[a]=t;return e},k=function(e){var o,a,t;B(e)||(e={}),a={};for(o in e)t=e[o],null!=t&&(a[o]=t);return a},R=function(e,o){var a,t;for(a in e)if(t=e[a],o[a]!==t)return!1;for(a in o)if(t=o[a],e[a]!==t)return!1;return!0},g=function(e,o){var a,t,l,n;if(e.length!==o.length)return!1;for(a=l=0,n=e.length;n>l;a=++l)if(t=e[a],o[a]!==t)return!1;return!0},x=function(e,o){var a,t,l;null==e&&(e={}),null==o&&(o={}),t={};for(a in e)l=e[a],o[a]!==l&&(t[a]=o[a]);for(a in o)l=o[a],e[a]!==l&&(t[a]=l);return t},(z===void 0||null===z)&&(z={}),null==(ro=z.log)&&(z.log=function(){}),null==(so=z.warn)&&(z.warn=function(){}),h=function(){function e(e){var o,a;a=e.components,o=e.childIndex,this.components=null!=a?a:[],this.childIndex=null!=o?o:0}return e}(),w=function(){function e(e){var o,a,t,l;l=null!=e?e:{},o=l.name,a=l.nodeType,t=l.parent,this.name=null!=o?o:"",this.nodeType=null!=a?a:null,this.parent=null!=t?t:null,this.routeSettings=null,this.childLiterals={},this.childVariable=null,this.bindings=[]}return e}(),m=function(){function e(e){var o,a,t,l,n,r;r=null!=e?e:{},t=r.setup,l=r.teardown,a=r.load,n=r.unload,o=r.context,this.setup=P(t)?t:function(){},this.load=P(a)?a:function(){},this.unload=P(n)?n:function(){},this.teardown=P(l)?l:function(){},this.context=B(o)?o:{}}return e}(),p=function(){function e(e){var o,a,t,l;l=null!=e?e:{},a=l.node,o=l.boundValues,t=l.parameterObservables,this.node=null!=a?a:null,this.boundValues=null!=o?o:[],this.parameterObservables=null!=t?t:[[]]}return e.prototype.getBindings=function(){var e,o,a,t,l,n;for(o={},n=this.node.bindings,a=t=0,l=n.length;l>t;a=++t)e=n[a],o[e]=this.boundValues[a];return V(o)},e.prototype.isEqual=function(e){return null!=e&&this.node===e.node&&g(this.boundValues,e.boundValues)},e.prototype.isRoot=function(){return null==this.node.parent},e.prototype.getParent=function(){var o,a,t,l,n;return null==this.node?null:(o=null!=(l=null!=(n=this.node.parent)?n.bindings.length:void 0)?l:0,a=this.boundValues.slice(0,o),t=this.parameterObservables.slice(0,-1),new e({node:this.node.parent,boundValues:a,parameterObservables:t}))},e.prototype.getChild=function(e){for(var o;null!=e&&!this.isEqual(o=e.getParent());)e=o;return e.parameterObservables=this.parameterObservables.slice(0),e.parameterObservables.push([]),e},e}(),f=function(){function e(e){this.callback=e,P(this.callback)||(this.callback=function(){}),this.dependencies=[],this.initialized=!1}return e.prototype.notify=function(e){var o,a=this;return o=function(){var o,t,l,n;if(!a.initialized)return!0;for(n=a.dependencies,t=0,l=n.length;l>t;t++)if(o=n[t],C(e,o))return!0;return!1}(),o?this.trigger():void 0},e.prototype.trigger=function(){var e,a=this;return this.dependencies=[],e=function(e){return C(a.dependencies,e)||a.dependencies.push(e),o[e]},this.callback(e),this.initialized=!0},e}(),i=new p({node:null}),c={Literal:"Literal",Variable:"Variable"},G=function(e){var o,a,t,l,n,r,d,s;if(e=D(e)?lo(e):"",t={},""!==e)for(d=e.split("&"),n=0,r=d.length;r>n;n++)a=d[n],s=a.split("=",2),o=s[0],l=s[1],t[o]=l;return V(t)},T=function(){var e;return"#"+(null!=(e=window.location.href.split("#",2)[1])?e:"")},J=function(e){return D(e)||(e=""),e=lo(e),"#"===e.slice(0,1)&&(e=e.slice(1)),window.location.hash=e},V=function(e){var o,a;if(B(e)||(e={}),u.CoerceParameterTypes)for(o in e)a=e[o],"true"===a?a=!0:"false"===a?a=!1:/^[0-9]+$/.test(a)?a=parseInt(a):/^[0-9]+\.[0-9]*$/.test(a)&&(a=parseFloat(a)),e[o]=a;return e},X=function(e){var o;return e=no(e),o=""===e?[]:e.split("/"),o.unshift("/"),o},K=function(e){var o,a,t,l,n,r,d,s,c;for(n=C(e,"[")||C(e,"]"),n&&function(){var o,a;return a=N(e,"["),1!==a?(a>1&&z.warn('Parsing failed on "'+e+'": Extra ['),1>a&&z.warn('Parsing failed on "'+e+'": Missing ['),null):(o=N(e,"]"),1!==o?(o>1&&z.warn('Parsing failed on "'+e+'": Extra ]'),1>o&&z.warn('Parsing failed on "'+e+'": Missing ]'),null):Y(e,"[")?void 0:(z.warn('Parsing failed on "'+e+'": [ not at beginning'),null))}(),l=e.replace(/[\[\]]/g,""),t=""===l?[]:X(l),s=0,c=t.length;c>s;s++)if(a=t[s],""===a)return z.warn('Parsing failed on "'+e+'": Blank component'),null;if(o=0,n){if(d=e.split("]")[0],r=X(d.replace("[","")),r[r.length-1]!==t[r.length-1])return z.warn('Parsing failed on "'+e+'": ] in the middle of a component'),null;if(r.length===t.length)return z.warn('Parsing failed on "'+e+'": No child components'),null;o=r.length}return new h({components:t,childIndex:o})},E=function(e){return Y(e,":")?c.Variable:c.Literal},O=function(e){switch(E(e)){case c.Literal:return e;case c.Variable:return e.slice(1)}},F=function(e,o,a){var t,l,n,r,d;return n=o.components,l=o.childIndex,r=e,t=[],(d=function(s,i){var u,f,h,b,_,p,v;if(i===l&&(r=s),0>=o.components.length)return s.parent=r,s.bindings=t,s.routeSettings=new m(a);switch(u=n.shift(),h=E(u),f=O(u),h){case c.Literal:b=null!=(p=(_=s.childLiterals)[f])?p:_[f]=new w({name:""+s.name+u+"/",nodeType:h,parent:e});break;case c.Variable:b=null!=(v=s.childVariable)?v:s.childVariable=new w({name:""+s.name+u+"/",nodeType:h,parent:e}),t.push(f)}return d(b,i+1)})(e,0)},L=function(e,o){var a,t,l;return l=X(o),a=[],(t=function(e,o){var l,n;if(0>=o.length&&null!=e.routeSettings)return new p({node:e,boundValues:a});if(l=o[0],null!=e.childLiterals[l]&&(n=t(e.childLiterals[l],o.slice(1)),null!=n))return n;if(null!=e.childVariable){if(a.push(l),n=t(e.childVariable,o.slice(1)),null!=n)return n;a.pop()}return null})(e,l)},y=function(e,o){var a,t,l,n,r;for(t=[],l=o;null!=l;)t.push(l),l=l.getParent();for(l=e;null!=l;){for(n=0,r=t.length;r>n;n++)if(a=t[n],l.isEqual(a))return l;l=l.getParent()}return null},_=a=t=null,b=o=null,n=e=null,r=!1,d=v=!1,s=!1,u={CoerceParameterTypes:!1},(M=function(){return _=new w({name:"*"}),a=i,b={},o={},t=null,n=null,e=null,r=!1,d=!1,v=!1,s=!1})(),Z=function(){var e;return null===t?$():s?to():t.isEqual(a)?eo():(e=y(a,t),a.isEqual(e)?oo():ao())},oo=function(){var e,o,l,n,r,d,s,c,i,u;return v=!0,n=(null!=(s=null!=(c=a.node)?c.routeSettings:void 0)?s:{context:null}).context,a=a.getChild(t),u=null!=(i=a.node.routeSettings)?i:{},o=u.context,d=u.setup,l=u.load,null==o&&(o={}),o.parent=n,null==d&&(d=function(){}),null==l&&(l=function(){}),e=a.getBindings(),r=function(){return Z()},2===d.length?d.call(o,e,r):(d.call(o,e),r())},eo=function(){var e,o,l,n,r,d,c;return n=function(){return s=!0,t=null,Z()},null==a.node?n():(c=null!=(d=a.node.routeSettings)?d:{},o=c.context,r=c.setup,l=c.load,null==o&&(o={}),null==r&&(r=function(){}),null==l&&(l=function(){}),e=a.getBindings(),2===l.length?l.call(o,e,n):(l.call(o,e),n()))},to=function(){var e,o,t,l,n,r;return s=!1,t=function(){return Z()},r=null!=(n=a.node.routeSettings)?n:{},o=r.context,l=r.unload,null==o&&(o={}),null==l&&(l=function(){}),e=a.getBindings(),2===l.length?l.call(o,e,t):(l.call(o,e),t())},ao=function(){var e,o,t,l,n,r;return v=!1,r=null!=(n=a.node.routeSettings)?n:{},o=r.context,l=r.teardown,null==o&&(o={}),null==l&&(l=function(){}),e=a.getBindings(),t=function(){return a=a.getParent(),Z()},2===l.length?l.call(o,e,t):(l.call(o,e),t())},$=function(){var e,t,l,n,r,d,s;for(e=A(x(b,o)),b=o,d=a.parameterObservables,s=[],n=0,r=d.length;r>n;n++)l=d[n],s.push(function(){var o,a,n;for(n=[],o=0,a=l.length;a>o;o++)t=l[o],n.push(t.notify(e));return n}());return s},j=function(){var o;return o=T(),Y(o,"#")&&(o=o.slice(1)),o=unescape(o),o!==e?l.call(o)?e=o:J(null!=e?e:""):void 0},l={route:function(e,o){var a,t;return P(o)&&(a=o,o={setup:a},o.load=2===a.length?function(e,o){return v?o():(d=!0,a(e,o))}:function(e){return v?void 0:(d=!0,a(e))}),B(o)||(o={}),D(e)||(e=""),e=lo(e),e.length>0||(e="/"),t=K(e),null==t?!1:(F(_,t,o),!0)},call:function(e){var l,n,r,d,s,c;return D(e)||(e="/"),""===e&&(e="/"),c=e.split("?",2),e=c[0],s=c[1],n=L(_,e),null==n?(z.log("FINCH WARNING: Could not find route for: "+e),!1):(d=G(s),l=n.getBindings(),o=q(d,l),null===t&&a.isEqual(n)?Z():(r=t,t=n,null==r&&Z()),!0)},reload:function(){return s?null==a||null==a.node?this:(t=a,Z(),this):this},observe:function(){var e,o,t,n;return e=arguments.length>=1?co.call(arguments,0):[],d?d=!1:(o=e.pop(),P(o)||(o=function(){}),e.length>0?(t=1===e.length&&S(e[0])?e[0]:e,l.observe(function(e){var a,l;return l=function(){var o,l,n;for(n=[],o=0,l=t.length;l>o;o++)a=t[o],n.push(e(a));return n}(),o.apply(null,l)})):(n=new f(o),Q(a.parameterObservables).push(n)))},abort:function(){return t=null},listen:function(){return r||("onhashchange"in window&&(P(window.addEventListener)?(window.addEventListener("hashchange",j,!0),r=!0):P(window.attachEvent)&&(window.attachEvent("hashchange",j),r=!0)),r||(n=setInterval(j,33),r=!0),j()),r},ignore:function(){return r&&(null!==n?(clearInterval(n),n=null,r=!1):"onhashchange"in window&&(P(window.removeEventListener)?(window.removeEventListener("hashchange",j,!0),r=!1):P(window.detachEvent)&&(window.detachEvent("hashchange",j),r=!1))),!r},navigate:function(e,o,a){var t,l,n,r,d,s,c,i,u,f,h,b,_;if(b=T().split("?",2),r=b[0],n=b[1],null==r&&(r=""),null==n&&(n=""),"#"===r.slice(0,1)&&(r=r.slice(1)),r=unescape(r),l=G(n),U(o)&&(a=o),B(e)&&(o=e),D(e)||(e=""),B(o)||(o={}),U(a)||(a=!1),e=lo(e),0===e.length&&(e=null),a&&(function(){var e,o,a;o={};for(e in l)a=l[e],o[unescape(e)]=unescape(a);return l=o}(),o=q(l,o)),null===e&&(e=r),_=e.split("?",2),e=_[0],u=_[1],"#"===e.slice(0,1)&&(e=e.slice(1)),Y(e,"./")||Y(e,"../")){for(t=r;Y(e,"./")||Y(e,"../");)i=e.indexOf("/"),s=e.slice(0,i),e=e.slice(i+1),".."===s&&(t=t.slice(0,t.lastIndexOf("/")));e=e.length>0?""+t+"/"+e:t}return f=D(u)?G(u):{},o=q(f,o),o=k(o),e=escape(e),c=function(){var e;e=[];for(d in o)h=o[d],e.push(escape(d)+"="+escape(h));return e}().join("&"),c.length>0&&(e+="?"+c),J(e)},reset:function(){l.options({CoerceParameterTypes:!1}),t=i,Z(),l.ignore(),M()},options:function(e){return q(u,e)}},this.Finch=l}).call(this);