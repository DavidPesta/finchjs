/*
	Finch.js - Powerfully simple javascript routing
	by Rick Allen (stoodder) and Greg Smith (smrq)

	Version 0.5.4
	Full source at https://github.com/stoodder/finchjs
	Copyright (c) 2011 RokkinCat, http://www.rokkincat.com

	MIT License, https://github.com/stoodder/finchjs/blob/master/LICENSE.md
	This file is generated by `cake build`, do not edit it by hand.
*/
(function(){var e,o,a,t,n,l,r,d,s,c,i,u,f,h,b,_,w,p,m,v,g,F,k,z,C,N,x,H,q,y,O,L,E,T,j,S,U,P,I,B,V,D,A,W,R,G,K,Q,$,M,J,X,Y,Z,eo,oo,ao,to,no,lo,ro,so,co,io=[].slice;B=function(e){return typeof e==typeof{}&&null!==e},P=function(e){return"[object Function]"===Object.prototype.toString.call(e)},U=function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},S=function(e){return"[object Array]"===Object.prototype.toString.call(e)},V=function(e){return"[object String]"===Object.prototype.toString.call(e)},I=function(e){return"[object Number]"===Object.prototype.toString.call(e)},no=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},lo=function(e){return e.replace(/^\//,"").replace(/\/$/,"")},Y=function(e,o){return 0===e.indexOf(o)},H=function(e,o){return-1!==e.indexOf(o,e.length-o.length)},C=function(e,o){var a,t,n;if(P(e.indexOf))return-1!==e.indexOf(o);if(S(e))for(t=0,n=e.length;n>t;t++)if(a=e[t],a===o)return!0;return!1},Q=function(e){return e[e.length-1]},N=function(e,o){return e.split(o).length-1},D=function(e){var o,a;a=[];for(o in e)a.push(o);return a},A=function(e){var o,a,t;t=[];for(o in e)a=e[o],t.push(a);return t},q=function(e,o){var a,t;B(e)||(e={}),B(o)||(o={});for(a in o)t=o[a],e[a]=t;return e},k=function(e){var o,a,t;B(e)||(e={}),a={};for(o in e)t=e[o],null!=t&&(a[o]=t);return a},W=function(e,o){var a,t;for(a in e)if(t=e[a],o[a]!==t)return!1;for(a in o)if(t=o[a],e[a]!==t)return!1;return!0},F=function(e,o){var a,t,n,l;if(e.length!==o.length)return!1;for(a=n=0,l=e.length;l>n;a=++n)if(t=e[a],o[a]!==t)return!1;return!0},x=function(e,o){var a,t,n;null==e&&(e={}),null==o&&(o={}),t={};for(a in e)n=e[a],o[a]!==n&&(t[a]=o[a]);for(a in o)n=o[a],e[a]!==n&&(t[a]=n);return t},z=null!=(ro=window.console)?ro:{},null==(so=z.log)&&(z.log=function(){}),null==(co=z.warn)&&(z.warn=function(){}),h=function(){function e(e){var o,a;a=e.components,o=e.childIndex,this.components=null!=a?a:[],this.childIndex=null!=o?o:0}return e}(),w=function(){function e(e){var o,a,t,n;n=null!=e?e:{},o=n.name,a=n.nodeType,t=n.parent,this.name=null!=o?o:"",this.nodeType=null!=a?a:null,this.parent=null!=t?t:null,this.routeSettings=null,this.childLiterals={},this.childVariable=null,this.bindings=[]}return e}(),m=function(){function e(e){var o,a,t,n,l,r;r=null!=e?e:{},t=r.setup,n=r.teardown,a=r.load,l=r.unload,o=r.context,this.setup=P(t)?t:function(){},this.load=P(a)?a:function(){},this.unload=P(l)?l:function(){},this.teardown=P(n)?n:function(){},this.context=B(o)?o:{}}return e}(),p=function(){function e(e){var o,a,t,n;n=null!=e?e:{},a=n.node,o=n.boundValues,t=n.parameterObservables,this.node=null!=a?a:null,this.boundValues=null!=o?o:[],this.parameterObservables=null!=t?t:[[]]}return e.prototype.getBindings=function(){var e,o,a,t,n,l;for(o={},l=this.node.bindings,a=t=0,n=l.length;n>t;a=++t)e=l[a],o[e]=this.boundValues[a];return R(o)},e.prototype.isEqual=function(e){return null!=e&&this.node===e.node&&F(this.boundValues,e.boundValues)},e.prototype.isRoot=function(){return null==this.node.parent},e.prototype.getParent=function(){var o,a,t,n,l;return null==this.node?null:(o=null!=(n=null!=(l=this.node.parent)?l.bindings.length:void 0)?n:0,a=this.boundValues.slice(0,o),t=this.parameterObservables.slice(0,-1),new e({node:this.node.parent,boundValues:a,parameterObservables:t}))},e.prototype.getChild=function(e){for(var o;null!=e&&!this.isEqual(o=e.getParent());)e=o;return e.parameterObservables=this.parameterObservables.slice(0),e.parameterObservables.push([]),e},e}(),f=function(){function e(e){this.callback=e,P(this.callback)||(this.callback=function(){}),this.dependencies=[],this.initialized=!1}return e.prototype.notify=function(e){var o,a=this;return o=function(){var o,t,n,l;if(!a.initialized)return!0;for(l=a.dependencies,t=0,n=l.length;n>t;t++)if(o=l[t],C(e,o))return!0;return!1}(),o?this.trigger():void 0},e.prototype.trigger=function(){var e,a=this;return this.dependencies=[],e=function(e){return C(a.dependencies,e)||a.dependencies.push(e),o[e]},this.callback(e),this.initialized=!0},e}(),i=new p({node:null}),c={Literal:"Literal",Variable:"Variable"},G=function(e){var o,a,t,n,l,r,d,s;if(e=V(e)?no(e):"",t={},""!==e)for(d=e.split("&"),l=0,r=d.length;r>l;l++)a=d[l],s=a.split("=",2),o=s[0],n=s[1],t[o]=n;return R(t)},T=function(){var e;return"#"+(null!=(e=window.location.href.split("#",2)[1])?e:"")},J=function(e){return V(e)||(e=""),e=no(e),"#"===e.slice(0,1)&&(e=e.slice(1)),window.location.hash=e},R=function(e){var o,a;if(B(e)||(e={}),u.CoerceParameterTypes)for(o in e)a=e[o],"true"===a?a=!0:"false"===a?a=!1:/^[0-9]+$/.test(a)?a=parseInt(a):/^[0-9]+\.[0-9]*$/.test(a)&&(a=parseFloat(a)),e[o]=a;return e},X=function(e){var o;return e=lo(e),o=""===e?[]:e.split("/"),o.unshift("/"),o},K=function(e){var o,a,t,n,l,r,d,s,c;for(l=C(e,"[")||C(e,"]"),l&&function(){var o,a;return a=N(e,"["),1!==a?(a>1&&z.warn('[FINCH] Parsing failed on "'+e+'": Extra ['),1>a&&z.warn('[FINCH] Parsing failed on "'+e+'": Missing ['),null):(o=N(e,"]"),1!==o?(o>1&&z.warn('[FINCH] Parsing failed on "'+e+'": Extra ]'),1>o&&z.warn('[FINCH] Parsing failed on "'+e+'": Missing ]'),null):Y(e,"[")?void 0:(z.warn('[FINCH] Parsing failed on "'+e+'": [ not at beginning'),null))}(),n=e.replace(/[\[\]]/g,""),t=""===n?[]:X(n),s=0,c=t.length;c>s;s++)if(a=t[s],""===a)return z.warn('[FINCH] Parsing failed on "'+e+'": Blank component'),null;if(o=0,l){if(d=e.split("]")[0],r=X(d.replace("[","")),r[r.length-1]!==t[r.length-1])return z.warn('[FINCH] Parsing failed on "'+e+'": ] in the middle of a component'),null;if(r.length===t.length)return z.warn('[FINCH] Parsing failed on "'+e+'": No child components'),null;o=r.length}return new h({components:t,childIndex:o})},E=function(e){return Y(e,":")?c.Variable:c.Literal},L=function(e){switch(E(e)){case c.Literal:return e;case c.Variable:return e.slice(1)}},g=function(e,o,a){var t,n,l,r,d;return l=o.components,n=o.childIndex,r=e,t=[],(d=function(s,i){var u,f,h,b,_,p,v;if(i===n&&(r=s),0>=o.components.length)return s.parent=r,s.bindings=t,s.routeSettings=new m(a);switch(u=l.shift(),h=E(u),f=L(u),h){case c.Literal:b=null!=(p=(_=s.childLiterals)[f])?p:_[f]=new w({name:""+s.name+u+"/",nodeType:h,parent:e});break;case c.Variable:b=null!=(v=s.childVariable)?v:s.childVariable=new w({name:""+s.name+u+"/",nodeType:h,parent:e}),t.push(f)}return d(b,i+1)})(e,0)},O=function(e,o){var a,t,n;return n=X(o),a=[],(t=function(e,o){var n,l;if(0>=o.length&&null!=e.routeSettings)return new p({node:e,boundValues:a});if(n=o[0],null!=e.childLiterals[n]&&(l=t(e.childLiterals[n],o.slice(1)),null!=l))return l;if(null!=e.childVariable){if(a.push(n),l=t(e.childVariable,o.slice(1)),null!=l)return l;a.pop()}return null})(e,n)},y=function(e,o){var a,t,n,l,r;for(t=[],n=o;null!=n;)t.push(n),n=n.getParent();for(n=e;null!=n;){for(l=0,r=t.length;r>l;l++)if(a=t[l],n.isEqual(a))return n;n=n.getParent()}return null},_=a=t=null,b=o=null,l=e=null,r=!1,d=v=!1,s=!1,u={CoerceParameterTypes:!1},($=function(){return _=new w({name:"*"}),a=i,b={},o={},t=null,l=null,e=null,r=!1,d=!1,v=!1,s=!1})(),Z=function(){var e;return null===t?M():s?to():t.isEqual(a)?eo():(e=y(a,t),a.isEqual(e)?oo():ao())},oo=function(){var e,o,n,l,r,d,s,c,i,u;return v=!0,l=(null!=(s=null!=(c=a.node)?c.routeSettings:void 0)?s:{context:null}).context,a=a.getChild(t),u=null!=(i=a.node.routeSettings)?i:{},o=u.context,d=u.setup,n=u.load,null==o&&(o={}),o.parent=l,null==d&&(d=function(){}),null==n&&(n=function(){}),e=a.getBindings(),r=function(){return Z()},2===d.length?d.call(o,e,r):(d.call(o,e),r())},eo=function(){var e,o,n,l,r,d,c;return l=function(){return s=!0,t=null,Z()},null==a.node?l():(c=null!=(d=a.node.routeSettings)?d:{},o=c.context,r=c.setup,n=c.load,null==o&&(o={}),null==r&&(r=function(){}),null==n&&(n=function(){}),e=a.getBindings(),2===n.length?n.call(o,e,l):(n.call(o,e),l()))},to=function(){var e,o,t,n,l,r;return s=!1,t=function(){return Z()},r=null!=(l=a.node.routeSettings)?l:{},o=r.context,n=r.unload,null==o&&(o={}),null==n&&(n=function(){}),e=a.getBindings(),2===n.length?n.call(o,e,t):(n.call(o,e),t())},ao=function(){var e,o,t,n,l,r;return v=!1,r=null!=(l=a.node.routeSettings)?l:{},o=r.context,n=r.teardown,null==o&&(o={}),null==n&&(n=function(){}),e=a.getBindings(),t=function(){return a=a.getParent(),Z()},2===n.length?n.call(o,e,t):(n.call(o,e),t())},M=function(){var e,t,n,l,r,d,s;for(e=D(x(b,o)),b=o,d=a.parameterObservables,s=[],l=0,r=d.length;r>l;l++)n=d[l],s.push(function(){var o,a,l;for(l=[],o=0,a=n.length;a>o;o++)t=n[o],l.push(t.notify(e));return l}());return s},j=function(){var o;return o=T(),Y(o,"#")&&(o=o.slice(1)),o=unescape(o),o!==e?n.call(o)?e=o:J(null!=e?e:""):void 0},n={route:function(e,o){var a,t;return P(o)&&(a=o,o={setup:a},o.load=2===a.length?function(e,o){return v?o():(d=!0,a(e,o))}:function(e){return v?void 0:(d=!0,a(e))}),B(o)||(o={}),V(e)||(e=""),e=no(e),e.length>0||(e="/"),t=K(e),null==t?!1:(g(_,t,o),!0)},call:function(e){var n,l,r,d,s,c;return V(e)||(e="/"),""===e&&(e="/"),c=e.split("?",2),e=c[0],s=c[1],l=O(_,e),null==l?(z.warn("[FINCH] Could not find route for: "+e),!1):(d=G(s),n=l.getBindings(),o=q(d,n),null===t&&a.isEqual(l)?Z():(r=t,t=l,null==r&&Z()),!0)},reload:function(){return s?null==a||null==a.node?this:(t=a,Z(),this):this},observe:function(){var e,o,t,l;return e=arguments.length>=1?io.call(arguments,0):[],d?d=!1:(o=e.pop(),P(o)||(o=function(){}),e.length>0?(t=1===e.length&&S(e[0])?e[0]:e,n.observe(function(e){var a,n;return n=function(){var o,n,l;for(l=[],o=0,n=t.length;n>o;o++)a=t[o],l.push(e(a));return l}(),o.apply(null,n)})):(l=new f(o),Q(a.parameterObservables).push(l)))},abort:function(){return t=null},listen:function(){return r||("onhashchange"in window&&(P(window.addEventListener)?(window.addEventListener("hashchange",j,!0),r=!0):P(window.attachEvent)&&(window.attachEvent("hashchange",j),r=!0)),r||(l=setInterval(j,33),r=!0),j()),r},ignore:function(){return r&&(null!==l?(clearInterval(l),l=null,r=!1):"onhashchange"in window&&(P(window.removeEventListener)?(window.removeEventListener("hashchange",j,!0),r=!1):P(window.detachEvent)&&(window.detachEvent("hashchange",j),r=!1))),!r},navigate:function(e,o,a){var t,n,l,r,d,s,c,i,u,f,h,b,_;if(b=T().split("?",2),r=b[0],l=b[1],null==r&&(r=""),null==l&&(l=""),"#"===r.slice(0,1)&&(r=r.slice(1)),r=unescape(r),n=G(l),U(o)&&(a=o),B(e)&&(o=e),V(e)||(e=""),B(o)||(o={}),U(a)||(a=!1),e=no(e),0===e.length&&(e=null),a&&(function(){var e,o,a;o={};for(e in n)a=n[e],o[unescape(e)]=unescape(a);return n=o}(),o=q(n,o)),null===e&&(e=r),_=e.split("?",2),e=_[0],u=_[1],"#"===e.slice(0,1)&&(e=e.slice(1)),Y(e,"./")||Y(e,"../")){for(t=r;Y(e,"./")||Y(e,"../");)i=e.indexOf("/"),s=e.slice(0,i),e=e.slice(i+1),".."===s&&(t=t.slice(0,t.lastIndexOf("/")));e=e.length>0?""+t+"/"+e:t}return f=V(u)?G(u):{},o=q(f,o),o=k(o),e=escape(e),c=function(){var e;e=[];for(d in o)h=o[d],e.push(escape(d)+"="+escape(h));return e}().join("&"),c.length>0&&(e+="?"+c),J(e)},reset:function(){n.options({CoerceParameterTypes:!1}),t=i,Z(),n.ignore(),$()},options:function(e){return q(u,e)}},this.Finch=n}).call(this);