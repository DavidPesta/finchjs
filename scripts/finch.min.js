/*
	Finch.js - Powerfully simple javascript routing
	by Rick Allen and Greg Smith

	Version 0.2.0
	Full source at https://github.com/stoodder/finchjs
	Copyright (c) 2011 RokkinCat, http://www.rokkincat.com

	MIT License, https://github.com/stoodder/finchjs/blob/master/LICENSE.md
	This file is generated by `cake build`, do not edit it by hand.
*/
((function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;t=function(a){return typeof a==typeof {}},r=function(a){return Object.prototype.toString.call(a)==="[object Function]"},q=function(a){return Object.prototype.toString.call(a)==="[object Array]"},u=function(a){return Object.prototype.toString.call(a)==="[object String]"},s=function(a){return Object.prototype.toString.call(a)==="[object Number]"},D=function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},E=function(a){return a.replace(/^\/+/,"").replace(/\/+$/,"")},B=function(a,b){return a.indexOf(b)===0},i=function(a,b){return a.indexOf(b,a.length-b.length)!==-1},g=function(a,b){return a.indexOf(b)!==-1},j=function(a,b){var c,d;t(a)||(a={}),t(b)||(b={});for(c in b)d=b[c],a[c]=d;return a},w=function(a,b){var c,d;for(c in a){d=a[c];if(b[c]!==d)return!1}for(c in b){d=b[c];if(a[c]!==d)return!1}return!0},f=function(a,b){var c,d,e;if(a.length!==b.length)return!1;for(c=0,e=a.length;c<e;c++){d=a[c];if(b[c]!==d)return!1}return!0},b={Literal:"Literal",Variable:"Variable"},d=function(){function a(a){var b,c;b=a.name,c=a.nodeType,this.name=b!=null?b:"",this.nodeType=c!=null?c:void 0,this.parentNode=void 0,this.route=void 0,this.childLiterals={},this.childVariable=void 0,this.bindings=[]}return a}(),c=function(){function a(a){var b,c,d,e;d=a.setup,c=a.load,e=a.teardown,b=a.context,this.setup=r(d)?d:function(){},this.load=r(c)?c:function(){},this.teardown=r(e)?e:function(){},this.context=t(b)?b:{}}return a}(),y=new d({name:"*"}),h={node:void 0,boundValues:{},parameters:{}},x=function(a){var b,c,d,e,f,g,h,i;a=u(a)?D(a):"",d={};if(a!==""){h=a.split("&");for(f=0,g=h.length;f<g;f++)c=h[f],i=c.split("=",2),b=i[0],e=i[1],d[b]=e}return d},p=function(a){var b;return B(a,"[")?(b=a.indexOf("]"),a.slice(1,b-1+1||9e9)):""},m=function(a){var b;return B(a,"[")?(b=a.indexOf("]"),a.slice(b+1)):a},A=function(a){return a=E(a),a===""?[]:a.split("/")},o=function(a){return B(a,":")?b.Variable:b.Literal},n=function(a){switch(o(a)){case b.Literal:return a;case b.Variable:return a.slice(1)}},e=function(a,e){var f,g,h,i,j;return i=A(p(a)),g=A(m(a)),h=void 0,f=[],(j=function(a,k){var l,m,p,q,r,s,t,u;l=void 0,r=!1,q=void 0;if(i.length<=0&&g.length<=0)return a.parentNode=h,a.bindings=f,a.route=new c(e);i.length>0?(l=i.shift(),i.length===0&&(r=!0)):l=g.shift(),p=o(l),m=n(l),k=""+k+"/"+l;switch(p){case b.Literal:q=(t=(s=a.childLiterals)[m])!=null?t:s[m]=new d({name:k,nodeType:p});break;case b.Variable:q=(u=a.childVariable)!=null?u:a.childVariable=new d({name:k,nodeType:p}),f.push(m)}return r&&(h=q),j(q,k)})(y,"")},l=function(a){var b,c,d;return d=A(a),b=[],(c=function(a){var e,f;if(d.length<=0)return{node:a,boundValues:b};e=d.shift();if(a.childLiterals[e]!=null){f=c(a.childLiterals[e]);if(f!=null)return f}if(a.childVariable!=null){b.push(e),f=c(a.childVariable);if(f!=null)return f;b.pop()}})(y)},k=function(a,c){var d,e,g,h,i,j,k,l,m,n,o;n=[a.node,a.boundValues],j=n[0],g=n[1],o=[c.node,c.boundValues],k=o[0],h=o[1],e=[],i=j;while(i!=null)e.push({node:i,boundValues:g}),i.nodeType===b.Variable&&(g=g.slice(0,g.length-1)),i=i.parentNode;i=k;while(i!=null){for(l=0,m=e.length;l<m;l++){d=e[l];if(d.node===i&&f(d.boundValues,h))return i}i.nodeType===b.Variable&&(h=h.slice(0,h.length-1)),i=i.parentNode}},z=function(a,b,c){var d;return(d=function(b,e){return b===a?e(c):d(b.parentNode,function(a){var c,d,f;return f=b.route,c=f.context,d=f.setup,d.length===2?d.call(c,a,function(b){return t(b)||(b={}),a=j({},a),j(a,b),e(a)}):(d.call(c,a),e(a))})})(b,function(a){var c,d,e;e=b.route,d=e.setup,c=e.load;if(d!==c)return v(b,a)})},v=function(a,b){var c,d,e;return e=a.route,c=e.context,d=e.load,d.call(c,b)},C=function(a){var b;return(b=function(c){var d;if(c!==a)return d=c.route.context,c.route.teardown.call(d),b(c.parentNode)})(h.node)},a={route:function(a,b){return r(b)&&(b={setup:b,load:b}),t(b)||(b={}),u(a)||(a=""),e(a,b)},call:function(a,b){var c,d,e,g,i,m,n,o,p;u(a)||(a=""),t(b)||(b={}),o=a.split("?",2),a=o[0],m=o[1],i=x(m),g=l(a);if(g==null)return!1;g.parameters=j(b,i),p=g.node.bindings;for(e=0,n=p.length;e<n;e++)d=p[e],g.parameters[d]=g.boundValues[e];return g.node===h.node&&f(g.boundValues,h.boundValues)?w(h.parameters,g.parameters)||v(g.node,g.parameters):(c=k({node:h.node,boundValues:h.boundValues},g),C(c),z(c,g.node,g.parameters)),h=g,!0},reset:function(){C(void 0),y=new d({name:"*"})}},this.Finch=a})).call(this)